!function(e){var t={};function s(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=2)}([function(e,t,s){"use strict";t.a=class{constructor(){this._connected=!1}get isFood(){return!1}get points(){return[[-1,-1]]}connected(){return this._connected}disconnect(){this._connected=!1}initialized(){return!1}place(){return!1}}},function(e,t,s){"use strict";var i=s(0);t.a=class extends i.a{constructor(){super(),this._points=[],this._grow=!1,this._angle=0}get points(){return this._points}get angle(){return this._angle}init(e,t){e instanceof Array&&t instanceof Array&&2===e.length&&2===t.length&&(this._points.push(e),this._points.push(t),e[0]<t[0]?this._angle=2:e[0]>t[0]?this._angle=0:e[1]<t[1]?this._angle=3:this._angle=1)}grow(){this._grow=!0}move(e,t,s=0,i=0){let n=this._points[this._points.length-1],r=[n[0]+s,n[1]+i],l=1;if(t(r,e.sizeX,e.sizeY))for(let t=0;t<e.items.length&&1===l;++t){let s=e.items[t],i=s.points;for(let e=0;e<i.length;++e)if(i[e][0]===r[0]&&i[e][1]===r[1]){s===this&&e===i.length-2?l=3:s.isFood?(l=2,s.eaten=!0):l=0;break}}else l=0;return l&&3!==l&&(this._grow?this._grow=!1:this._points.splice(0,1),this._points.push(r)),l}moveNext(e){switch(this._angle){case 0:return this.moveLeft(e);case 1:return this.moveUp(e);case 2:return this.moveRight(e);case 3:return this.moveDown(e)}return 1}moveLeft(e){let t=this.move(e,e=>e[0]>=0,-1);return 3===t?this.moveNext(e):(this._angle=0,t)}moveRight(e){let t=this.move(e,(e,t)=>e[0]<t,1);return 3===t?this.moveNext(e):(this._angle=2,t)}moveUp(e){let t=this.move(e,e=>e[1]>=0,0,-1);return 3===t?this.moveNext(e):(this._angle=1,t)}moveDown(e){let t=this.move(e,(e,t,s)=>e[1]<s,0,1);return 3===t?this.moveNext(e):(this._angle=3,t)}initialized(){return this._points.length>1}place(e){if(!this.initialized())return!1;let t=!e.items.some(e=>e.points.some(e=>this._points.some(t=>t[0]===e[0]&&t[1]===e[1])));return t&&(this._connected=!0),t}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(3),n=(s.n(i),s(4)),r=s(9),l=s(10);document.addEventListener("DOMContentLoaded",function(){let e=new n.a(l.a);e.setCellRenderer(r.a),e.createFieldLayout()?e.run(!1,!0):console.log("Could not create a field layout.")})},function(e,t){},function(e,t,s){"use strict";var i=s(5),n=s(7),r=s(1),l=s(8);t.a=class{constructor(e=null,t=10,s=20,i=300,n=10,r=25,o=25,a=1,h=4,d=null){this._field=new l.a(t,s),this._elements={display:document.getElementById("snake-display"),highScore:document.getElementById("high-score"),score:document.getElementById("score"),level:document.getElementById("level"),speed:document.getElementById("speed"),gameOver:document.getElementById("game-over"),help:document.getElementById("help"),pause:document.getElementById("pause"),colorsEnableButton:document.getElementById("snake-colors-enable"),vibrationEnableButton:document.getElementById("snake-vibration-enable"),helpButton:document.getElementById("snake-help"),pauseButton:document.getElementById("snake-pause"),resetButton:document.getElementById("snake-reset"),leftButton:document.getElementById("snake-left"),upButton:document.getElementById("snake-up"),rightButton:document.getElementById("snake-right"),downButton:document.getElementById("snake-down")},this._sizeX=t,this._sizeY=s,this._snake=null,this._input=[],this._iterationTimer=null,this._level=-1,this._speed=0,this._speedFactor=n,this.highScore=Number(localStorage.getItem("snakeHighScore"));let u=localStorage.getItem("snakeColorsEnable");this.colorsEnable=null!==u&&"true"===u;let _=localStorage.getItem("snakeVibrationEnable");this.vibrationEnable=null===_||"true"===_,this._score=0,this._levelScore=0,this._showHelp=!1,this._baseSpeed=i,this._baseSpeedIterationsCount=r,this._speedIterationsCount=r,this._shouldGenerateFood=!1,this._foodLifeTime=o,this._foodFactor=a,this._pause=!1,this._inputQueueLimit=h,this._levels=e,this._cellRenderer=d,this._activePrerenderedCell=null,this._inactivePrerenderedCell=null,this._foodPrerenderedCell=null,this._snakePrerenderedCell=null,this._shouldRedrawDisplay=!1,this._animationTimer=null,this.nextIteration=this.nextIteration.bind(this),this._onKeyUp=this._onKeyUp.bind(this),this.redrawDisplay=this.redrawDisplay.bind(this),this.render=this.render.bind(this),this._availableKeys=[37,38,39,40,65,87,68,83],this._bindButtons()}get highScore(){return this._highScore}get score(){return this._score}get level(){return this._level}get speed(){return this._speed}get gameOver(){return this._gameOver}get colorsEnable(){return this._colorsEnable}get vibrationEnable(){return this._vibrationEnable}set highScore(e){this._highScore=e,this._elements.highScore.innerHTML=e}set score(e){this._score=e,this.highScore<e&&(this.highScore=e),this._elements.score.innerHTML=e}set level(e){this._level=e,this._elements.level.innerHTML=e}set speed(e){this._speed=e,this._elements.speed.innerHTML=e}set gameOver(e){this._gameOver=!!e,this._elements.gameOver.innerHTML=e?"GAME<br>OVER":""}set colorsEnable(e){this._colorsEnable=!!e,this._elements.colorsEnableButton.className="push-button push-button_small"+(e?" push-button_active":""),localStorage.setItem("snakeColorsEnable",this._colorsEnable),this.redrawDisplay()}set vibrationEnable(e){this._vibrationEnable=!!e,this._elements.vibrationEnableButton.className="push-button push-button_small"+(e?" push-button_active":""),localStorage.setItem("snakeVibrationEnable",this._vibrationEnable)}destroy(){this.stop(),this.clearFieldLayout()}setCellRenderer(e){"function"==typeof e&&(this._cellRenderer=e)}render(){const e=this._field.table(),t=this._elements.display,s=t.width/this._sizeX,i=t.height/this._sizeY,n=t.getContext("2d");for(let t=0;t<e.length;++t){let r;switch(n.clearRect(e[t].x*s,e[t].y*i,s,i),e[t].value){case 0:r=this._inactivePrerenderedCell;break;case 1:r=this._foodPrerenderedCell;break;case 2:r=this._snakePrerenderedCell;break;case 3:r=this._activePrerenderedCell}n.drawImage(r,e[t].x*s,e[t].y*i)}this._animationTimer=requestAnimationFrame(this.render)}run(e=!1,t=!1){let s,n;this.reset(t),this.gameOver=!1,this._speedIterationsCount=this._baseSpeedIterationsCount,this._snake=new r.a,this._levelScore=0,(t||e)&&([s,n]=this._levelUp()),s&&n||(n=[(s=[Math.ceil(this._field.sizeX/2),Math.ceil(this._field.sizeY/2)])[0],s[1]-1]),this._snake.init(s,n),this._field.addItem(this._snake),this.render();let l=new i.a(this._foodLifeTime);this._field.addItem(l),e||this._bindEvents(),this._iterationTimer=setTimeout(this.nextIteration,this._timeout())}stop(){this._iterationTimer&&(clearTimeout(this._iterationTimer),this._iterationTimer=null),window.removeEventListener("keyup",this._onKeyUp),window.removeEventListener("resize",this.redrawDisplay),this.reset()}reset(e=!1){this._animationTimer&&(cancelAnimationFrame(this._animationTimer),this._animationTimer=null),this._field.clear(),this._shouldGenerateFood=!1,this._speedIterationsCount=this._baseSpeedIterationsCount,e||(this.score=0,this.speed=0,this.level=-1),this._input=[],this._iterationTimer=null,this._pause=!1}nextIteration(){this._shouldRedrawDisplay&&this._redrawDisplay(),--this._speedIterationsCount,this._speedIterationsCount||(++this.speed,this._speedIterationsCount=this._baseSpeedIterationsCount);let e=!0,t=!0,s=this._field.items.filter(e=>e.isFood);switch(s.forEach(e=>{e.lifeTime>0&&--e.lifeTime}),this._input.shift()){case 87:case 38:e=this._snake.moveUp(this._field);break;case 83:case 40:e=this._snake.moveDown(this._field);break;case 65:case 37:e=this._snake.moveLeft(this._field);break;case 68:case 39:e=this._snake.moveRight(this._field);break;default:t=!1}if(t||(e=this._snake.moveNext(this._field)),!e){this.gameOver=!0;let e=Number(localStorage.getItem("snakeHighScore"));return this.highScore=Math.max(e,this.highScore),void localStorage.setItem("snakeHighScore",this.highScore)}if(2===e){if(s.filter(e=>e.eaten).forEach(e=>{this._incrementLevelScore(Math.max(1,e.lifeTime*this._foodFactor)),this._field.removeItem(e)}),this._levelScore>=this._levels[this.level%this._levels.length].score)return void this.run(!1,!0);this._snake.grow(),this._shouldGenerateFood=!0}if(this._shouldGenerateFood){this._shouldGenerateFood=!1;let e=new i.a(this._foodLifeTime);this._field.addItem(e)}this._iterationTimer=setTimeout(this.nextIteration,this._timeout())}addInput(e){const t=this._input,s=t.length;this._availableKeys.includes(e)&&s<this._inputQueueLimit&&(!s||t[s-1]!==e)&&t.push(e)}createFieldLayout(){if(!this._cellRenderer)return!1;const e=this._sizeX,t=this._sizeY,s=this._elements.display;s.width=s.clientWidth,s.height=s.clientHeight;const i=s.getContext("2d"),n=s.width/e,r=s.height/t,l=this.colorsEnable;this._activePrerenderedCell=this._cellRenderer(n,r,!0),this._inactivePrerenderedCell=this._cellRenderer(n,r),this._foodPrerenderedCell=this._cellRenderer(n,r,!0,l?"food":"default"),this._snakePrerenderedCell=this._cellRenderer(n,r,!0,l?"snake":"default");for(let s=0;s<e;++s)for(let e=0;e<t;++e)i.drawImage(this._inactivePrerenderedCell,s*n,e*r);return!0}clearFieldLayout(){const e=this._elements.display;e.width=e.clientWidth,e.height=e.clientHeight}redrawDisplay(){this.gameOver?this._redrawDisplay():this._shouldRedrawDisplay=!0}_incrementLevelScore(e){this._levelScore+=e,this.score+=e}_levelUp(){++this.level;const e=this._levels[this.level%this._levels.length];this.speed=e.speed+Math.floor(this.level/this._levels.length);for(let t=0;t<e.items.length;++t){const s=e.items[t];if("wall"===s.type){let e=new n.a;e.start=s.start,e.end=s.end,this._field.addItem(e)}}return[e.snakeStart,e.snakeEnd]}_bindEvents(){window.addEventListener("keyup",this._onKeyUp),window.addEventListener("resize",this.redrawDisplay)}_onKeyUp(e){if(82===e.keyCode||13===e.keyCode){if(this._showHelp||this._pause)return;if(this._iterationTimer)return clearTimeout(this._iterationTimer),this._iterationTimer=null,void this.run(!0)}else{if(80===e.keyCode||32===e.keyCode)return void(this._showHelp||this._togglePause());72===e.keyCode||27===e.keyCode?(this._showHelp=!this._showHelp,this._elements.help.className="help"+(this._showHelp?"":" help_hidden"),this._elements.helpButton.className="push-button push-button_small"+(this._showHelp?" push-button_active":""),this._pause||this._togglePause(!0)):67===e.keyCode?this.colorsEnable=!this.colorsEnable:86===e.keyCode&&(this.vibrationEnable=!this.vibrationEnable)}this.addInput(e.keyCode)}_togglePause(e=!1){this.gameOver||(this._iterationTimer?(clearTimeout(this._iterationTimer),this._iterationTimer=null,this._elements.pause.innerHTML="PAUSE",this._elements.pauseButton.className="push-button push-button_big push-button_active",e||(this._pause=!0)):(this._iterationTimer=setTimeout(this.nextIteration,this._timeout()),this._elements.pause.innerHTML="",this._elements.pauseButton.className="push-button push-button_big",e||(this._pause=!1)))}_timeout(){return this._baseSpeed-this._speed*this._speedFactor}_bindButtons(){let e=e=>(function(){e(),this.vibrationEnable&&navigator.vibrate(35)}).bind(this);this._elements.pauseButton.addEventListener("click",e(()=>this._onKeyUp({keyCode:32}))),this._elements.resetButton.addEventListener("click",e(()=>this._onKeyUp({keyCode:13}))),this._elements.leftButton.addEventListener("click",e(()=>this.addInput(37))),this._elements.upButton.addEventListener("click",e(()=>this.addInput(38))),this._elements.rightButton.addEventListener("click",e(()=>this.addInput(39))),this._elements.downButton.addEventListener("click",e(()=>this.addInput(40))),this._elements.helpButton.addEventListener("click",e(()=>this._onKeyUp({keyCode:27}))),this._elements.colorsEnableButton.addEventListener("click",e(()=>this.colorsEnable=!this.colorsEnable)),this._elements.vibrationEnableButton.addEventListener("click",e(()=>this.vibrationEnable=!this.vibrationEnable))}_redrawDisplay(){this._shouldRedrawDisplay=!1,this._field.clearPreviousTable(),this.createFieldLayout(),this.render()}}},function(e,t,s){"use strict";var i=s(6);t.a=class extends i.a{constructor(e=20,t=-1,s=-1){super(e),this._x=t,this._y=s}get points(){return[[this._x,this._y]]}get x(){return this._x}get y(){return this._y}set x(e){this._x=e}set y(e){this._y=e}initialized(){return this._x>=0&&this._y>=0}place(e){if(this._connected)return!1;if(this.initialized())return!e.items.some(e=>e.points.some(e=>e[0]===this._x&&e[1]===this._y));const t=e.freeCells();if(!t)return!1;let s=t[Math.floor(Math.random()*t.length)];return this.y=Math.floor(s/e.sizeX),this.x=s%e.sizeX,this._connected=!0,!0}}},function(e,t,s){"use strict";var i=s(0);t.a=class extends i.a{constructor(e=25){super(),this._lifeTime=e,this._eaten=!1}get isFood(){return!0}get lifeTime(){return this._lifeTime}get eaten(){return this._eaten}set lifeTime(e){this._lifeTime=e}set eaten(e){this._eaten=!!e}}},function(e,t,s){"use strict";var i=s(0);t.a=class extends i.a{constructor(){super(),this._points=[],this._start=[-1,-1],this._end=[-1,-1]}get points(){return this._points}get start(){return this._start}get end(){return this._end}set start(e){this._start=[e[0],e[1]],this._updatePoints()}set end(e){this._end=[e[0],e[1]],this._updatePoints()}initialized(){return this._points.length>1}place(e){return!(this._connected||!this.initialized()||e.items.some(e=>e.points.some(e=>this._points.some(t=>e[0]===t[0]&&e[1]===t[1])))||(this._connected=!0,0))}_updatePoints(){const e=this._start,t=this._end;if(-1===e[0]||-1===e[1]||-1===t[0]||-1===t[1])return void(this._points=[]);let s=[];for(let i=Math.min(e[0],t[0]);i<=Math.max(e[0],t[0]);++i)for(let n=Math.min(e[1],t[1]);n<=Math.max(e[1],t[1]);++n)s.push([i,n]);this._points=s}}},function(e,t,s){"use strict";var i=s(0),n=s(1);t.a=class{constructor(e,t){this._sizeX=e,this._sizeY=t,this._items=[],this._count=0,this._maxCount=this._sizeX*this._sizeY,this._previousTable=null}get items(){return this._items.slice()}table(){let e=[],t=new Array(this._maxCount).fill(0);const s=this._sizeX,i=this._sizeY;if(this._previousTable){for(let e=0;e<this._items.length;++e){let i=this._items[e],r=i.points;for(let e=0;e<r.length;++e){let l=r[e],o=s*l[1]+l[0];i.isFood?t[o]=i.lifeTime<6&&i.lifeTime%2!=0?0:1:i instanceof n.a?t[o]=2:t[o]=3}}for(let n=0;n<s;++n)for(let r=0;r<i;++r){let i=s*r+n,l=t[i];this._previousTable[i]!==l&&e.push({x:n,y:r,value:l})}}else for(let i=0;i<this._items.length;++i){let r=this._items[i],l=r.points;for(let i=0;i<l.length;++i){let o,a=l[i];(o=r.isFood?r.lifeTime<6&&r.lifeTime%2!=0?0:1:r instanceof n.a?2:3)&&e.push({x:a[0],y:a[1],value:o}),t[s*a[1]+a[0]]=o}}return this._previousTable=t,e}get sizeX(){return this._sizeX}get sizeY(){return this._sizeY}get count(){return this._count}available(){return this._maxCount-this._count>0}addItem(e){return!!(e instanceof i.a&&this.available()&&-1===this._items.findIndex(t=>t===e)&&e.place(this))&&(this._items.push(e),this._count+=e.points.length,!0)}removeItem(e){let t=this._items.findIndex(t=>t===e);-1!==t&&(this._count-=e.points.length,this._items.splice(t,1))}clear(){this._items=[],this._count=0}freeCells(){if(!this._previousTable)return null;const e=this._previousTable;let t=[];for(let s=0;s<e.length;++s)e[s]||t.push(s);return t}clearPreviousTable(){this._previousTable=null}}},function(e,t,s){"use strict";t.a=function(e,t,s=!1,i="default"){const n=document.createElement("canvas");n.width=e,n.height=t;const r=n.getContext("2d"),l=.03555*e,o=.03555*t,a=Math.min(.075*e,.075*t),h=.2*e,d=.2*t,u=(()=>s?"food"===i?"rgba(135, 64, 80, 0.9)":"snake"===i?"#0c3a4f":"rgba(0, 0, 0, 0.9)":"rgba(0, 0, 0, 0.2)")();return r.strokeStyle=u,r.fillStyle=u,r.lineWidth=a,r.strokeRect(l+a/2,o+a/2,e-2*l-a,t-2*o-a),r.fillRect(h,d,e-2*h,t-2*d),n}},function(e,t,s){"use strict";t.a=[{speed:0,score:100,items:[]},{speed:0,score:150,items:[{type:"wall",start:[1,1],end:[2,2]},{type:"wall",start:[7,1],end:[8,2]}]},{speed:0,score:200,items:[{type:"wall",start:[1,1],end:[2,2]},{type:"wall",start:[7,1],end:[8,2]},{type:"wall",start:[1,17],end:[2,18]},{type:"wall",start:[7,17],end:[8,18]}]},{speed:0,score:250,items:[{type:"wall",start:[1,1],end:[1,4]},{type:"wall",start:[2,1],end:[4,1]},{type:"wall",start:[3,3],end:[4,4]},{type:"wall",start:[4,18],end:[7,18]},{type:"wall",start:[8,15],end:[8,18]},{type:"wall",start:[5,15],end:[6,16]}]},{speed:0,score:300,items:[{type:"wall",start:[1,1],end:[1,10]},{type:"wall",start:[2,1],end:[4,1]},{type:"wall",start:[3,3],end:[4,6]},{type:"wall",start:[2,18],end:[7,17]},{type:"wall",start:[8,12],end:[8,18]},{type:"wall",start:[9,0],end:[9,2]}]},{speed:0,score:350,items:[{type:"wall",start:[0,3],end:[1,3]},{type:"wall",start:[0,14],end:[5,14]},{type:"wall",start:[2,6],end:[2,11]},{type:"wall",start:[3,6],end:[4,6]},{type:"wall",start:[3,11],end:[6,11]},{type:"wall",start:[4,3],end:[6,3]},{type:"wall",start:[7,3],end:[7,11]},{type:"wall",start:[4,17],end:[7,19]},{type:"wall",start:[8,14],end:[9,14]}]}]}]);